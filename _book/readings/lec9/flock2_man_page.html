
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>flock(2) man page Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="locks3_man_page.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../lec1/">
            
                <a href="../lec1/">
            
                    
                    Lecture 1: Introduction to Operating Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../lec1/Principles.html">
            
                <a href="../lec1/Principles.html">
            
                    
                    Principles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../lec1/intro.html">
            
                <a href="../lec1/intro.html">
            
                    
                    Introduction to Operating Systems
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../lec2/">
            
                <a href="../lec2/">
            
                    
                    Lecture 2: Software and Interface Stability
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../lec2/Interface_stability.html">
            
                <a href="../lec2/Interface_stability.html">
            
                    
                    Interface Stability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../lec2/Software_interfaces.html">
            
                <a href="../lec2/Software_interfaces.html">
            
                    
                    Software Interfaces
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../lec3/">
            
                <a href="../lec3/">
            
                    
                    Lecture 3: Interface Stability and Software Interfaces
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../lec3/Interface_Stability.html">
            
                <a href="../lec3/Interface_Stability.html">
            
                    
                    Interface Stability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../lec3/Software_Interfaces.html">
            
                <a href="../lec3/Software_Interfaces.html">
            
                    
                    Software Interfaces
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../lec4/">
            
                <a href="../lec4/">
            
                    
                    Lecture 4: CPU and Virtualization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../lec4/Linking_and_libraries.html">
            
                <a href="../lec4/Linking_and_libraries.html">
            
                    
                    Linking and Libraries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../lec4/cpu-api.html">
            
                <a href="../lec4/cpu-api.html">
            
                    
                    CPU API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../lec4/cpu-intro.html">
            
                <a href="../lec4/cpu-intro.html">
            
                    
                    CPU Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../lec4/cpu-mechanisms.html">
            
                <a href="../lec4/cpu-mechanisms.html">
            
                    
                    CPU Mechanisms
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../lec5/">
            
                <a href="../lec5/">
            
                    
                    Lecture 5: CPU Scheduling
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../lec5/cpu-sched-mlfq.html">
            
                <a href="../lec5/cpu-sched-mlfq.html">
            
                    
                    CPU Scheduling - MLFQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../lec5/cpu-sched.html">
            
                <a href="../lec5/cpu-sched.html">
            
                    
                    CPU Scheduling
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../lec6/">
            
                <a href="../lec6/">
            
                    
                    Lecture 6: Virtual Memory
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../lec6/Garbage_Collection.html">
            
                <a href="../lec6/Garbage_Collection.html">
            
                    
                    Garbage Collection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../lec6/vm-api.html">
            
                <a href="../lec6/vm-api.html">
            
                    
                    VM API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../lec6/vm-freespace.html">
            
                <a href="../lec6/vm-freespace.html">
            
                    
                    VM Free Space Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../lec6/vm-intro.html">
            
                <a href="../lec6/vm-intro.html">
            
                    
                    VM Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../lec6/vm-mechanism.html">
            
                <a href="../lec6/vm-mechanism.html">
            
                    
                    VM Mechanisms
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="../lec6/vm-segmentation.html">
            
                <a href="../lec6/vm-segmentation.html">
            
                    
                    VM Segmentation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../lec7/">
            
                <a href="../lec7/">
            
                    
                    Lecture 7: Advanced VM
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../lec7/Working_set_page_replacement.html">
            
                <a href="../lec7/Working_set_page_replacement.html">
            
                    
                    Working Set Page Replacement
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../lec7/vm-beyondphys-policy.html">
            
                <a href="../lec7/vm-beyondphys-policy.html">
            
                    
                    Beyond Physical Memory - Policy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../lec7/vm-beyondphys.html">
            
                <a href="../lec7/vm-beyondphys.html">
            
                    
                    Beyond Physical Memory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../lec7/vm-paging.html">
            
                <a href="../lec7/vm-paging.html">
            
                    
                    Paging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="../lec7/vm-tlbs.html">
            
                <a href="../lec7/vm-tlbs.html">
            
                    
                    TLBs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../lec8/">
            
                <a href="../lec8/">
            
                    
                    Lecture 8: Concurrency and Threads
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../lec8/Introduction_to_IPC.html">
            
                <a href="../lec8/Introduction_to_IPC.html">
            
                    
                    Introduction to IPC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../lec8/User-Mode_Threads.html">
            
                <a href="../lec8/User-Mode_Threads.html">
            
                    
                    User-Mode Threads
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../lec8/threads-api.html">
            
                <a href="../lec8/threads-api.html">
            
                    
                    Threads API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../lec8/threads-intro.html">
            
                <a href="../lec8/threads-intro.html">
            
                    
                    Threads Introduction
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="./">
            
                <a href="./">
            
                    
                    Lecture 9: Synchronization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.10.1" data-path="flock2_man_page.html">
            
                <a href="flock2_man_page.html">
            
                    
                    flock(2) man page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="locks3_man_page.html">
            
                <a href="locks3_man_page.html">
            
                    
                    locks(3) man page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="threads-locks.html">
            
                <a href="threads-locks.html">
            
                    
                    Threads and Locks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../lec10/">
            
                <a href="../lec10/">
            
                    
                    Lecture 10: Threads - Advanced Concepts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../lec10/threads-cv.html">
            
                <a href="../lec10/threads-cv.html">
            
                    
                    Threads - Condition Variables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../lec10/threads-locks-usage.html">
            
                <a href="../lec10/threads-locks-usage.html">
            
                    
                    Threads - Locks Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../lec10/threads-sema.html">
            
                <a href="../lec10/threads-sema.html">
            
                    
                    Threads - Semaphores
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../lec11/">
            
                <a href="../lec11/">
            
                    
                    Lecture 11: Debugging and Synchronization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../lec11/Deadlock_Avoidance.html">
            
                <a href="../lec11/Deadlock_Avoidance.html">
            
                    
                    Deadlock Avoidance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../lec11/Health_Monitoring.html">
            
                <a href="../lec11/Health_Monitoring.html">
            
                    
                    Health Monitoring
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="../lec11/Java_intrinsic_locks.html">
            
                <a href="../lec11/Java_intrinsic_locks.html">
            
                    
                    Java Intrinsic Locks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="../lec11/Java_synchronization.html">
            
                <a href="../lec11/Java_synchronization.html">
            
                    
                    Java Synchronization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5" data-path="../lec11/threads-bugs.html">
            
                <a href="../lec11/threads-bugs.html">
            
                    
                    Threads - Debugging
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../lec12/">
            
                <a href="../lec12/">
            
                    
                    Lecture 12: Device Drivers and Storage
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../lec12/Devices_Classes_and_Services.html">
            
                <a href="../lec12/Devices_Classes_and_Services.html">
            
                    
                    Devices, Classes, and Services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="../lec12/Dynamically_loadable_device_drivers.html">
            
                <a href="../lec12/Dynamically_loadable_device_drivers.html">
            
                    
                    Dynamically Loadable Device Drivers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3" data-path="../lec12/file-devices.html">
            
                <a href="../lec12/file-devices.html">
            
                    
                    File Devices
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../lec13/">
            
                <a href="../lec13/">
            
                    
                    Lecture 13: File Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../lec13/File_types.html">
            
                <a href="../lec13/File_types.html">
            
                    
                    File Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="../lec13/The_FAT_file_system.html">
            
                <a href="../lec13/The_FAT_file_system.html">
            
                    
                    The FAT File System
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3" data-path="../lec13/file-implementation.html">
            
                <a href="../lec13/file-implementation.html">
            
                    
                    File Implementation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.4" data-path="../lec13/file-intro.html">
            
                <a href="../lec13/file-intro.html">
            
                    
                    Introduction to File Systems
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../lec14/">
            
                <a href="../lec14/">
            
                    
                    Lecture 14: The Fast File System
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../lec14/file-ffs.html">
            
                <a href="../lec14/file-ffs.html">
            
                    
                    The Fast File System (FFS)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../lec15/">
            
                <a href="../lec15/">
            
                    
                    Lecture 15: Modern File Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../lec15/file-journaling.html">
            
                <a href="../lec15/file-journaling.html">
            
                    
                    Journaling File Systems
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2" data-path="../lec15/file-lfs.html">
            
                <a href="../lec15/file-lfs.html">
            
                    
                    Log-structured File Systems
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3" data-path="../lec15/file-ssd.html">
            
                <a href="../lec15/file-ssd.html">
            
                    
                    Solid State Drives and File Systems
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../lec16/">
            
                <a href="../lec16/">
            
                    
                    Lecture 16: Virtual Machine Monitors
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.17.1" data-path="../lec16/vmm-intro.html">
            
                <a href="../lec16/vmm-intro.html">
            
                    
                    Introduction to VMM
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="../lec17/">
            
                <a href="../lec17/">
            
                    
                    Lecture 17: Security
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.18.1" data-path="../lec17/dialogue-security.html">
            
                <a href="../lec17/dialogue-security.html">
            
                    
                    Dialogue on Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.2" data-path="../lec17/security-access.html">
            
                <a href="../lec17/security-access.html">
            
                    
                    Access Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.3" data-path="../lec17/security-authentication.html">
            
                <a href="../lec17/security-authentication.html">
            
                    
                    Authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.4" data-path="../lec17/security-crypto.html">
            
                <a href="../lec17/security-crypto.html">
            
                    
                    Cryptography
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.5" data-path="../lec17/security-intro.html">
            
                <a href="../lec17/security-intro.html">
            
                    
                    Introduction to Security
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="../lec18/">
            
                <a href="../lec18/">
            
                    
                    Lecture 18: Distributed Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.19.1" data-path="../lec18/Distributed_Systems-Goals_and_Challenges.html">
            
                <a href="../lec18/Distributed_Systems-Goals_and_Challenges.html">
            
                    
                    Distributed Systems: Goals and Challenges
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19.2" data-path="../lec18/Leases.html">
            
                <a href="../lec18/Leases.html">
            
                    
                    Leases
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19.3" data-path="../lec18/dist-intro.html">
            
                <a href="../lec18/dist-intro.html">
            
                    
                    Introduction to Distributed Systems
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19.4" data-path="../lec18/security-distributed.html">
            
                <a href="../lec18/security-distributed.html">
            
                    
                    Security in Distributed Systems
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="../lec19/">
            
                <a href="../lec19/">
            
                    
                    Lecture 19: Distributed File Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.20.1" data-path="../lec19/dist-afs.html">
            
                <a href="../lec19/dist-afs.html">
            
                    
                    The Andrew File System (AFS)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.2" data-path="../lec19/dist-nfs.html">
            
                <a href="../lec19/dist-nfs.html">
            
                    
                    Network File System (NFS)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.21" data-path="../ppt.html">
            
                <a href="../ppt.html">
            
                    
                    PPT
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >flock(2) man page</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="flock2-man-page">flock(2) man page</h1>
<pre><code>flock(2)                   System Calls Manual                  flock(2)
</code></pre><h2 id="name-----top">NAME     <a href="https://man7.org/linux/man-pages/man2/flock.2.html#top_of_page" target="_blank">top</a></h2>
<pre><code>       flock - apply or remove an advisory lock on an open file
</code></pre><h2 id="library-----top">LIBRARY     <a href="https://man7.org/linux/man-pages/man2/flock.2.html#top_of_page" target="_blank">top</a></h2>
<pre><code>       Standard C library (libc, -lc)
</code></pre><h2 id="synopsis-----top">SYNOPSIS     <a href="https://man7.org/linux/man-pages/man2/flock.2.html#top_of_page" target="_blank">top</a></h2>
<pre><code>       #include &lt;sys/file.h&gt;

       int flock(int fd, int operation);
</code></pre><h2 id="description-----top">DESCRIPTION     <a href="https://man7.org/linux/man-pages/man2/flock.2.html#top_of_page" target="_blank">top</a></h2>
<pre><code>       Apply or remove an advisory lock on the open file specified by
       fd.  The argument operation is one of the following:

           LOCK_SH  Place a shared lock.  More than one process may hold
                    a shared lock for a given file at a given time.

           LOCK_EX  Place an exclusive lock.  Only one process may hold
                    an exclusive lock for a given file at a given time.

           LOCK_UN  Remove an existing lock held by this process.

       A call to flock() may block if an incompatible lock is held by
       another process.  To make a nonblocking request, include LOCK_NB
       (by ORing) with any of the above operations.

       A single file may not simultaneously have both shared and
       exclusive locks.

       Locks created by flock() are associated with an open file
       description (see open(2)).  This means that duplicate file
       descriptors (created by, for example, fork(2) or dup(2)) refer to
       the same lock, and this lock may be modified or released using
       any of these file descriptors.  Furthermore, the lock is released
       either by an explicit LOCK_UN operation on any of these duplicate
       file descriptors, or when all such file descriptors have been
       closed.

       If a process uses open(2) (or similar) to obtain more than one
       file descriptor for the same file, these file descriptors are
       treated independently by flock().  An attempt to lock the file
       using one of these file descriptors may be denied by a lock that
       the calling process has already placed via another file
       descriptor.

       A process may hold only one type of lock (shared or exclusive) on
       a file.  Subsequent flock() calls on an already locked file will
       convert an existing lock to the new lock mode.

       Locks created by flock() are preserved across an execve(2).

       A shared or exclusive lock can be placed on a file regardless of
       the mode in which the file was opened.
</code></pre><h2 id="return-value-----top">RETURN VALUE     <a href="https://man7.org/linux/man-pages/man2/flock.2.html#top_of_page" target="_blank">top</a></h2>
<pre><code>       On success, zero is returned.  On error, -1 is returned, and
       errno is set to indicate the error.
</code></pre><h2 id="errors-----top">ERRORS     <a href="https://man7.org/linux/man-pages/man2/flock.2.html#top_of_page" target="_blank">top</a></h2>
<pre><code>       EBADF  fd is not an open file descriptor.

       EINTR  While waiting to acquire a lock, the call was interrupted
              by delivery of a signal caught by a handler; see
              signal(7).

       EINVAL operation is invalid.

       ENOLCK The kernel ran out of memory for allocating lock records.

       EWOULDBLOCK
              The file is locked and the LOCK_NB flag was selected.
</code></pre><h2 id="versions-----top">VERSIONS     <a href="https://man7.org/linux/man-pages/man2/flock.2.html#top_of_page" target="_blank">top</a></h2>
<pre><code>       Since Linux 2.0, flock() is implemented as a system call in its
       own right rather than being emulated in the GNU C library as a
       call to fcntl(2).  With this implementation, there is no
       interaction between the types of lock placed by flock() and
       fcntl(2), and flock() does not detect deadlock.  (Note, however,
       that on some systems, such as the modern BSDs, flock() and
       fcntl(2) locks do interact with one another.)

   CIFS details
       Up to Linux 5.4, flock() is not propagated over SMB.  A file with
       such locks will not appear locked for remote clients.

       Since Linux 5.5, flock() locks are emulated with SMB byte-range
       locks on the entire file.  Similarly to NFS, this means that
       fcntl(2) and flock() locks interact with one another.  Another
       important side-effect is that the locks are not advisory anymore:
       any IO on a locked file will always fail with EACCES when done
       from a separate file descriptor.  This difference originates from
       the design of locks in the SMB protocol, which provides mandatory
       locking semantics.

       Remote and mandatory locking semantics may vary with SMB
       protocol, mount options and server type.  See mount.cifs(8) for
       additional information.
</code></pre><h2 id="standards-----top">STANDARDS     <a href="https://man7.org/linux/man-pages/man2/flock.2.html#top_of_page" target="_blank">top</a></h2>
<pre><code>       BSD.
</code></pre><h2 id="history-----top">HISTORY     <a href="https://man7.org/linux/man-pages/man2/flock.2.html#top_of_page" target="_blank">top</a></h2>
<pre><code>       4.4BSD (the flock() call first appeared in 4.2BSD).  A version of
       flock(), possibly implemented in terms of fcntl(2), appears on
       most UNIX systems.

   NFS details
       Up to Linux 2.6.11, flock() does not lock files over NFS (i.e.,
       the scope of locks was limited to the local system).  Instead,
       one could use fcntl(2) byte-range locking, which does work over
       NFS, given a sufficiently recent version of Linux and a server
       which supports locking.

       Since Linux 2.6.12, NFS clients support flock() locks by
       emulating them as fcntl(2) byte-range locks on the entire file.
       This means that fcntl(2) and flock() locks do interact with one
       another over NFS.  It also means that in order to place an
       exclusive lock, the file must be opened for writing.

       Since Linux 2.6.37, the kernel supports a compatibility mode that
       allows flock() locks (and also fcntl(2) byte region locks) to be
       treated as local; see the discussion of the local_lock option in
       nfs(5).
</code></pre><h2 id="notes-----top">NOTES     <a href="https://man7.org/linux/man-pages/man2/flock.2.html#top_of_page" target="_blank">top</a></h2>
<pre><code>       flock() places advisory locks only; given suitable permissions on
       a file, a process is free to ignore the use of flock() and
       perform I/O on the file.

       flock() and fcntl(2) locks have different semantics with respect
       to forked processes and dup(2).  On systems that implement
       flock() using fcntl(2), the semantics of flock() will be
       different from those described in this manual page.

       Converting a lock (shared to exclusive, or vice versa) is not
       guaranteed to be atomic: the existing lock is first removed, and
       then a new lock is established.  Between these two steps, a
       pending lock request by another process may be granted, with the
       result that the conversion either blocks, or fails if LOCK_NB was
       specified.  (This is the original BSD behavior, and occurs on
       many other implementations.)
</code></pre><h2 id="see-also-----top">SEE ALSO     <a href="https://man7.org/linux/man-pages/man2/flock.2.html#top_of_page" target="_blank">top</a></h2>
<pre><code>       flock(1), close(2), dup(2), execve(2), fcntl(2), fork(2),
       open(2), lockf(3), lslocks(8)

       Documentation/filesystems/locks.txt in the Linux kernel source
       tree (Documentation/locks.txt in older kernels)
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Lecture 9: Synchronization">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="locks3_man_page.html" class="navigation navigation-next " aria-label="Next page: locks(3) man page">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"flock(2) man page","level":"1.10.1","depth":2,"next":{"title":"locks(3) man page","level":"1.10.2","depth":2,"path":"readings/lec9/locks3_man_page.md","ref":"readings/lec9/locks3_man_page.md","articles":[]},"previous":{"title":"Lecture 9: Synchronization","level":"1.10","depth":1,"path":"readings/lec9/README.md","ref":"readings/lec9/README.md","articles":[{"title":"flock(2) man page","level":"1.10.1","depth":2,"path":"readings/lec9/flock2_man_page.md","ref":"readings/lec9/flock2_man_page.md","articles":[]},{"title":"locks(3) man page","level":"1.10.2","depth":2,"path":"readings/lec9/locks3_man_page.md","ref":"readings/lec9/locks3_man_page.md","articles":[]},{"title":"Threads and Locks","level":"1.10.3","depth":2,"path":"readings/lec9/threads-locks.md","ref":"readings/lec9/threads-locks.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"readings/lec9/flock2_man_page.md","mtime":"2024-03-11T18:09:51.958Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-03-22T16:16:21.401Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

