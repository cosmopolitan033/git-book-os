
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Devices, Classes, and Services Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Dynamically_loadable_device_drivers.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../lec1/">
            
                <a href="../lec1/">
            
                    
                    Lecture 1: Introduction to Operating Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../lec1/Principles.html">
            
                <a href="../lec1/Principles.html">
            
                    
                    Principles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../lec1/intro.html">
            
                <a href="../lec1/intro.html">
            
                    
                    Introduction to Operating Systems
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../lec2/">
            
                <a href="../lec2/">
            
                    
                    Lecture 2: Software and Interface Stability
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../lec2/Interface_stability.html">
            
                <a href="../lec2/Interface_stability.html">
            
                    
                    Interface Stability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../lec2/Software_interfaces.html">
            
                <a href="../lec2/Software_interfaces.html">
            
                    
                    Software Interfaces
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../lec3/">
            
                <a href="../lec3/">
            
                    
                    Lecture 3: Interface Stability and Software Interfaces
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../lec3/Interface_Stability.html">
            
                <a href="../lec3/Interface_Stability.html">
            
                    
                    Interface Stability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../lec3/Software_Interfaces.html">
            
                <a href="../lec3/Software_Interfaces.html">
            
                    
                    Software Interfaces
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../lec4/">
            
                <a href="../lec4/">
            
                    
                    Lecture 4: CPU and Virtualization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../lec4/Linking_and_libraries.html">
            
                <a href="../lec4/Linking_and_libraries.html">
            
                    
                    Linking and Libraries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../lec4/cpu-api.html">
            
                <a href="../lec4/cpu-api.html">
            
                    
                    CPU API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../lec4/cpu-intro.html">
            
                <a href="../lec4/cpu-intro.html">
            
                    
                    CPU Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../lec4/cpu-mechanisms.html">
            
                <a href="../lec4/cpu-mechanisms.html">
            
                    
                    CPU Mechanisms
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../lec5/">
            
                <a href="../lec5/">
            
                    
                    Lecture 5: CPU Scheduling
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../lec5/cpu-sched-mlfq.html">
            
                <a href="../lec5/cpu-sched-mlfq.html">
            
                    
                    CPU Scheduling - MLFQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../lec5/cpu-sched.html">
            
                <a href="../lec5/cpu-sched.html">
            
                    
                    CPU Scheduling
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../lec6/">
            
                <a href="../lec6/">
            
                    
                    Lecture 6: Virtual Memory
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../lec6/Garbage_Collection.html">
            
                <a href="../lec6/Garbage_Collection.html">
            
                    
                    Garbage Collection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../lec6/vm-api.html">
            
                <a href="../lec6/vm-api.html">
            
                    
                    VM API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../lec6/vm-freespace.html">
            
                <a href="../lec6/vm-freespace.html">
            
                    
                    VM Free Space Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../lec6/vm-intro.html">
            
                <a href="../lec6/vm-intro.html">
            
                    
                    VM Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../lec6/vm-mechanism.html">
            
                <a href="../lec6/vm-mechanism.html">
            
                    
                    VM Mechanisms
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="../lec6/vm-segmentation.html">
            
                <a href="../lec6/vm-segmentation.html">
            
                    
                    VM Segmentation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../lec7/">
            
                <a href="../lec7/">
            
                    
                    Lecture 7: Advanced VM
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../lec7/Working_set_page_replacement.html">
            
                <a href="../lec7/Working_set_page_replacement.html">
            
                    
                    Working Set Page Replacement
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../lec7/vm-beyondphys-policy.html">
            
                <a href="../lec7/vm-beyondphys-policy.html">
            
                    
                    Beyond Physical Memory - Policy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../lec7/vm-beyondphys.html">
            
                <a href="../lec7/vm-beyondphys.html">
            
                    
                    Beyond Physical Memory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../lec7/vm-paging.html">
            
                <a href="../lec7/vm-paging.html">
            
                    
                    Paging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="../lec7/vm-tlbs.html">
            
                <a href="../lec7/vm-tlbs.html">
            
                    
                    TLBs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../lec8/">
            
                <a href="../lec8/">
            
                    
                    Lecture 8: Concurrency and Threads
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../lec8/Introduction_to_IPC.html">
            
                <a href="../lec8/Introduction_to_IPC.html">
            
                    
                    Introduction to IPC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../lec8/User-Mode_Threads.html">
            
                <a href="../lec8/User-Mode_Threads.html">
            
                    
                    User-Mode Threads
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../lec8/threads-api.html">
            
                <a href="../lec8/threads-api.html">
            
                    
                    Threads API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../lec8/threads-intro.html">
            
                <a href="../lec8/threads-intro.html">
            
                    
                    Threads Introduction
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../lec9/">
            
                <a href="../lec9/">
            
                    
                    Lecture 9: Synchronization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../lec9/flock2_man_page.html">
            
                <a href="../lec9/flock2_man_page.html">
            
                    
                    flock(2) man page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../lec9/locks3_man_page.html">
            
                <a href="../lec9/locks3_man_page.html">
            
                    
                    locks(3) man page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../lec9/threads-locks.html">
            
                <a href="../lec9/threads-locks.html">
            
                    
                    Threads and Locks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../lec10/">
            
                <a href="../lec10/">
            
                    
                    Lecture 10: Threads - Advanced Concepts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../lec10/threads-cv.html">
            
                <a href="../lec10/threads-cv.html">
            
                    
                    Threads - Condition Variables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../lec10/threads-locks-usage.html">
            
                <a href="../lec10/threads-locks-usage.html">
            
                    
                    Threads - Locks Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../lec10/threads-sema.html">
            
                <a href="../lec10/threads-sema.html">
            
                    
                    Threads - Semaphores
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../lec11/">
            
                <a href="../lec11/">
            
                    
                    Lecture 11: Debugging and Synchronization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../lec11/Deadlock_Avoidance.html">
            
                <a href="../lec11/Deadlock_Avoidance.html">
            
                    
                    Deadlock Avoidance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../lec11/Health_Monitoring.html">
            
                <a href="../lec11/Health_Monitoring.html">
            
                    
                    Health Monitoring
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="../lec11/Java_intrinsic_locks.html">
            
                <a href="../lec11/Java_intrinsic_locks.html">
            
                    
                    Java Intrinsic Locks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="../lec11/Java_synchronization.html">
            
                <a href="../lec11/Java_synchronization.html">
            
                    
                    Java Synchronization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5" data-path="../lec11/threads-bugs.html">
            
                <a href="../lec11/threads-bugs.html">
            
                    
                    Threads - Debugging
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="./">
            
                <a href="./">
            
                    
                    Lecture 12: Device Drivers and Storage
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.13.1" data-path="Devices_Classes_and_Services.html">
            
                <a href="Devices_Classes_and_Services.html">
            
                    
                    Devices, Classes, and Services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="Dynamically_loadable_device_drivers.html">
            
                <a href="Dynamically_loadable_device_drivers.html">
            
                    
                    Dynamically Loadable Device Drivers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3" data-path="file-devices.html">
            
                <a href="file-devices.html">
            
                    
                    File Devices
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../lec13/">
            
                <a href="../lec13/">
            
                    
                    Lecture 13: File Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../lec13/File_types.html">
            
                <a href="../lec13/File_types.html">
            
                    
                    File Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="../lec13/The_FAT_file_system.html">
            
                <a href="../lec13/The_FAT_file_system.html">
            
                    
                    The FAT File System
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3" data-path="../lec13/file-implementation.html">
            
                <a href="../lec13/file-implementation.html">
            
                    
                    File Implementation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.4" data-path="../lec13/file-intro.html">
            
                <a href="../lec13/file-intro.html">
            
                    
                    Introduction to File Systems
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../lec14/">
            
                <a href="../lec14/">
            
                    
                    Lecture 14: The Fast File System
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../lec14/file-ffs.html">
            
                <a href="../lec14/file-ffs.html">
            
                    
                    The Fast File System (FFS)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../lec15/">
            
                <a href="../lec15/">
            
                    
                    Lecture 15: Modern File Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../lec15/file-journaling.html">
            
                <a href="../lec15/file-journaling.html">
            
                    
                    Journaling File Systems
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2" data-path="../lec15/file-lfs.html">
            
                <a href="../lec15/file-lfs.html">
            
                    
                    Log-structured File Systems
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3" data-path="../lec15/file-ssd.html">
            
                <a href="../lec15/file-ssd.html">
            
                    
                    Solid State Drives and File Systems
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../lec16/">
            
                <a href="../lec16/">
            
                    
                    Lecture 16: Virtual Machine Monitors
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.17.1" data-path="../lec16/vmm-intro.html">
            
                <a href="../lec16/vmm-intro.html">
            
                    
                    Introduction to VMM
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="../lec17/">
            
                <a href="../lec17/">
            
                    
                    Lecture 17: Security
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.18.1" data-path="../lec17/dialogue-security.html">
            
                <a href="../lec17/dialogue-security.html">
            
                    
                    Dialogue on Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.2" data-path="../lec17/security-access.html">
            
                <a href="../lec17/security-access.html">
            
                    
                    Access Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.3" data-path="../lec17/security-authentication.html">
            
                <a href="../lec17/security-authentication.html">
            
                    
                    Authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.4" data-path="../lec17/security-crypto.html">
            
                <a href="../lec17/security-crypto.html">
            
                    
                    Cryptography
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.5" data-path="../lec17/security-intro.html">
            
                <a href="../lec17/security-intro.html">
            
                    
                    Introduction to Security
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Devices, Classes, and Services</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="devices-classes-and-services">Devices, Classes, and Services</h1>
<p>Device Drivers: Classes and Services</p>
<h2 id="introduction">Introduction</h2>
<p>Device drivers represent both:</p>
<ul>
<li>generalizing abstractions</li>
</ul>
<p>  gathering a myriad of very different devices together and synthesizing a few general classes (e.g. disks, network interfaces, graphics adaptors) and standard models, behaviors and interfaces to be implemented by all drivers for a given class.</p>
<ul>
<li>simplifying abstractions</li>
</ul>
<p>  providing an implemention of standard class interfaces while opaquely encapsulating the details of how to effectively and efficiently use a particular device.</p>
<p>For reasons of performance and control, Operating Systems tend not to be implemented in object oriented languages (does anybody remember JavaOS?). Yet despite being implemented in simpler langauges (often C), Operating Systems, in device drivers, offer highly evolved examples of a different realization of class interfaces, derivation, and inheritance.</p>
<p>Whether we are talking about storage, networking, video, or human-interface, the number of available devices is huge and growing. The number and diversity of these devices creates tremendous demands for object oriented code reuse:</p>
<ul>
<li>We want the system to behave similarly, no matter what the underlying devices were being used to provide storage, networking, etc. To ensure this, we would like most of the higher level functionality to be implemented in common, higher level modules.</li>
<li>We would like to minimize the cost of developing drivers to support new devices. This is most easily done if the majority of the functionality is implemented in common code that can be inherrited by the individual drivers.</li>
<li>As system functionality and performance are improved, we would like to ensure that those benefits accrue not only to new device drivers, but also to older device drivers.</li>
</ul>
<p>These needs can be satisfied by implementing the higher level functionality (associated with each general class of device) in common code that uses per-device implementations of a standard sub-class driver to operate over a particular device. This requires:</p>
<ul>
<li>deriving device-driver sub-classes for each of the major classes of device.</li>
<li>defining sub-class specific interfaces to be implemented by the drivers for all devices in each of those classes.</li>
<li>creating per-device implementations of those standard sub-class interfaces.</li>
</ul>
<h2 id="major-driver-classes">Major Driver Classes</h2>
<p>In the earliest versions of Unix, all devices were divided into two fundamental classes, which are still present in all Unix derivatives:</p>
<ul>
<li><p>block devices</p>
<p>These are random-access devices, addressable in fixed size (e.g. 512 byte, 4K byte) blocks. Their drivers implement a <em>request</em> method to enqueue asynchronous DMA requests. The request descriptor included information about the desired operation (e.g. byte count, target device, disk address and in-memory buffer address) as well as completion information (how much data was transferred, error indications) and a condition variable the requestor could use to await the eventual completion of the request.A read or write request could be issued for any number of blocks, but in most cases a large request would be broken into multiple single-block requests, each of which would be passed, block at a time, through the system buffer cache. For this reason block device drivers also implement a <em>fsync</em> method to flush out any buffered writes.</p>
</li>
<li><p>character devices</p>
<p>These devices may be sequential access, or may be byte-addressable. They support the standard synchronous <em>read(2)</em>, <em>write(2)</em> and (indirectly) <em>seek(2)</em> operations.For devices that supported DMA, read and write operations were expected to be done as a single (potentially very large) DMA transfer between the device and the buffers in user address space.</p>
</li>
</ul>
<p>A key point here is that, even in the oldest Unix systems, device drivers were divided into distinct classes (implementing different interfaces) based on the needs of distinct classes of clients:</p>
<ul>
<li>Block devices were designed to be used, within the operating system, by file systems, to access disks. Forcing all I/O to go through the system buffer cache is almost surely the right thing to do with file system I/O.</li>
<li>Character devices were designed to be used directly by applications. The potential for large DMA transfers directly between the device and user-space buffers meant that character (or <em>raw</em>) I/O operations might be much more efficient than the corresponding requests to a block device.</li>
</ul>
<p>These two major classes of device were not mutually exclusive. A single driver could export both block and character interfaces. A file system would be mounted on top of the block device, while back-up and integrity-checking software might access the disk through its (potentially much more efficient) character device<em>. All device drivers support </em>initialize<em> and </em>cleanup<em> methods (for dynamic module loading and unloading), </em>open<em> and </em>release<em> methods (roughly corresponding to the </em>open(2)<em> and </em>close(2)<em> system calls), and an optional catch-all </em>ioctl(2)* method.</p>
<p><img src="https://lasr.cs.ucla.edu/classes/111_fall16/readings/device_drivers/driver_ddi.jpg" alt="block/char Venn diagram"></p>
<p>*In more contemporary systems, it is possible for a client to specify that block I/O should not be passed through the system buffer cache.</p>
<h2 id="driver-sub-classes">Driver sub-classes</h2>
<p>Given the fundamental importance of file systems and disks to operating systems, it is not surprising that block device drivers would have been singled out as a special sub-class in even the earliest versions of Unix. But as system functionality evolved, the operating system began to implement higher level services for other sub-classes of devices:</p>
<ul>
<li>input editing and outut translation for terminals and virtual terminals</li>
<li>address binding and packet sending/receipt for network interfaces</li>
<li>display mapping and window management for graphics adaptors</li>
<li>character-set mapping for keyboards</li>
<li>cursor positioning for pointing devices</li>
<li>sample mixing, volume and equalization for sound devices</li>
</ul>
<p><img src="https://lasr.cs.ucla.edu/classes/111_fall16/readings/device_drivers/driver_clients.jpg" alt="img"></p>
<p>And as each of these sub-systems evolved, new device driver methods<em> were defined to enable more effective communication between the higher level frameworks and the lower level device drivers in each sub-class. Each of these sub-class specific interfaces is referred to as a </em>Device Driver Interface* (DDI).</p>
<p><img src="https://lasr.cs.ucla.edu/classes/111_fall16/readings/device_drivers/driver_sub_ddi.jpg" alt="img"></p>
<p>*It should be noted that in some cases, the higher frameworks have been implemented in user-mode, so that some of the new interfaces have been specified as behavior rather than new methods.</p>
<p>The rewards for this structure are:</p>
<ul>
<li>Sub-class drivers become easier to implement because so much of the important functionality is implemented in higher level software.</li>
<li>The system behaves identically over a wide range of different devices.</li>
<li>Most functionality enhancements to will be in the higher level code, and so should automatically work on all devices within that sub-class.</li>
</ul>
<p>But the price for these rewards is that all device drivers must implement exactly the same interfaces:</p>
<ul>
<li>if a driver does not (correctly) implement the standard interfaces for its device sub-class, it will not work with the higher level software.</li>
<li>if a driver implements additional functionality (not defined in the standard interfaces for its device sub-class), those features will not be exploited by the standard higher level software.</li>
</ul>
<h2 id="services-for-device-drivers">Services for Device Drivers</h2>
<p>It is nearly impossible to implement a completely self-contained device driver. Most device drivers are likely to require a range of resources and services from the operating system:</p>
<ul>
<li>dynamic memory allocation</li>
<li>I/O and bus resource allocation and management</li>
<li>condition variable operations (wait and signal)</li>
<li>mutual exclusion</li>
<li>control of, and being called to service interrupts</li>
<li>DMA target pin/release, scatter/gather map management</li>
<li>configuration/registry services</li>
</ul>
<p>The collection of services, exposed by the operating system for use by device drivers is sometimes referred to as the <em>Driver-Kernel Interface</em> (DKI). Interface stability for DKI functions is every bit as important as it is for the DDI entry points. If an operating system eliminates or incompatibly changes a DKI function, device drivers that depend on that function may cease working. The requirement to maintain stable DKI entry points may greatly constrain our ability to evolve our operating system implementation. Similar issues arrise for other classes of dynamically loadable kernel modules (such as network protocols and file systems).</p>
<h2 id="conclusion">Conclusion</h2>
<p>Device drivers demonstrate an evolution from a basic super-class (character devices) into an ever-expanding hierarchy of derived sub-classes. But unlike traditional class derivation, where sub-class implementations inherit most of their implemntation from their parent, we see a different sort of inheritance. While each new sub-class and instance is likely to be a new implementation, what they inherit is pre-existing higher level frameworks that do do most of their work for them.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Lecture 12: Device Drivers and Storage">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Dynamically_loadable_device_drivers.html" class="navigation navigation-next " aria-label="Next page: Dynamically Loadable Device Drivers">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Devices, Classes, and Services","level":"1.13.1","depth":2,"next":{"title":"Dynamically Loadable Device Drivers","level":"1.13.2","depth":2,"path":"readings/lec12/Dynamically_loadable_device_drivers.md","ref":"readings/lec12/Dynamically_loadable_device_drivers.md","articles":[]},"previous":{"title":"Lecture 12: Device Drivers and Storage","level":"1.13","depth":1,"path":"readings/lec12/README.md","ref":"readings/lec12/README.md","articles":[{"title":"Devices, Classes, and Services","level":"1.13.1","depth":2,"path":"readings/lec12/Devices_Classes_and_Services.md","ref":"readings/lec12/Devices_Classes_and_Services.md","articles":[]},{"title":"Dynamically Loadable Device Drivers","level":"1.13.2","depth":2,"path":"readings/lec12/Dynamically_loadable_device_drivers.md","ref":"readings/lec12/Dynamically_loadable_device_drivers.md","articles":[]},{"title":"File Devices","level":"1.13.3","depth":2,"path":"readings/lec12/file-devices.md","ref":"readings/lec12/file-devices.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"readings/lec12/Devices_Classes_and_Services.md","mtime":"2024-03-11T17:24:13.782Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-03-12T00:45:26.750Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

